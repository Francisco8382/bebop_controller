\hypertarget{square__root__controller_8cpp_source}{}\doxysection{square\+\_\+root\+\_\+controller.\+cpp}
\label{square__root__controller_8cpp_source}\index{C:/Users/franc/Desktop/Ubuntu/bebop\_controller/src/bebop\_controller/src/nodes/square\_root\_controller.cpp@{C:/Users/franc/Desktop/Ubuntu/bebop\_controller/src/bebop\_controller/src/nodes/square\_root\_controller.cpp}}
\mbox{\hyperlink{square__root__controller_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{square__root__controller_8h}{square\_root\_controller.h}}"{}}}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00006}00006 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacebebop__controller}{bebop\_controller}} \{}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00008}\mbox{\hyperlink{classbebop__controller_1_1_square_root_controller_ad8f8f7865d8071768be6ef9580340ba7}{00008}}     \mbox{\hyperlink{classbebop__controller_1_1_square_root_controller_ad8f8f7865d8071768be6ef9580340ba7}{SquareRootController::SquareRootController}}()\{}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00009}00009         ros::NodeHandle pnh(\textcolor{stringliteral}{"{}\string~"{}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00010}00010         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Gains/Px"{}}, \mbox{\hyperlink{pid__controller__angles_8h_a3dd348ce991235ccb39c5a19b3d93589}{PxDefaultValue}}, \&P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_ae685746d7246756a70902737ac1d2fa7}{x}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00011}00011         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Gains/Py"{}}, \mbox{\hyperlink{pid__controller__angles_8h_a8654e0a8831ffeaa4317e1be94b47fc8}{PyDefaultValue}}, \&P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a6ab61b14159b24c1f362f21d6826a83d}{y}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00012}00012         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Gains/Pz"{}}, \mbox{\hyperlink{pid__controller__angles_8h_accc76b47bca72fb2722615edd004276a}{PzDefaultValue}}, \&P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a89b6834e6fceddeeea981a74692279fa}{z}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00013}00013         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Gains/Pyaw"{}}, \mbox{\hyperlink{pid__controller__angles_8h_a5501588d717ab46e7a7dd644409ff2bb}{PyawDefaultValue}}, \&P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a86c14a81c8b8e58d8f04d90e9221b4ec}{yaw}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00014}00014         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Reference\_Gains/X"{}}, \mbox{\hyperlink{citc__controller__angles_8h_ad16e0ed5c907e6ae8c7846d33a26f796}{RGxDefaultValue}}, \&RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_ae685746d7246756a70902737ac1d2fa7}{x}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00015}00015         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Reference\_Gains/Y"{}}, \mbox{\hyperlink{citc__controller__angles_8h_ae702824d792edac413f7c92647d98a58}{RGyDefaultValue}}, \&RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a6ab61b14159b24c1f362f21d6826a83d}{y}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00016}00016         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Reference\_Gains/Z"{}}, \mbox{\hyperlink{citc__controller__angles_8h_a32f62ae8da691dc1d80e27ae0fe66864}{RGzDefaultValue}}, \&RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a89b6834e6fceddeeea981a74692279fa}{z}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00017}00017         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, \textcolor{stringliteral}{"{}Reference\_Gains/Yaw"{}}, \mbox{\hyperlink{citc__controller__angles_8h_aaf901f72c664b73897c98110c3248318}{RGyawDefaultValue}}, \&RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a86c14a81c8b8e58d8f04d90e9221b4ec}{yaw}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00018}00018         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, std::string(\textcolor{stringliteral}{"{}Normalize/Max\_Horizontal\_Speed"{}}), }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00019}00019                         \mbox{\hyperlink{citc__controller__twist_8h_af17cf138df64392be34c9138160d32ed}{MAX\_HORIZONTAL\_SPEED}}, \&norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a492721ca2a4bd29f5ac5b07c8a5a5700}{horizontal}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00020}00020         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, std::string(\textcolor{stringliteral}{"{}Normalize/Max\_Vertical\_Speed"{}}), }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00021}00021                         \mbox{\hyperlink{citc__controller__angles_8h_a6658f60cf267cb3ebb85791a92b59f7e}{MAX\_VERTICAL\_SPEED}}, \&norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a1c8c966f6384984fc6127ffb1dc148c4}{vertical}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00022}00022         \mbox{\hyperlink{namespacebebop__controller_a32600fdf0c17428368f53f564a490449}{GetRosParameter}}(pnh, std::string(\textcolor{stringliteral}{"{}Normalize/Max\_Rotation\_Speed"{}}), }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00023}00023                         \mbox{\hyperlink{citc__controller__angles_8h_a90f7cac8b5a6a9933579c83f7852552e}{MAX\_ROTATION\_SPEED}}, \&norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a81ea78bea6e2f30c01893c5d00039dc8}{rotation}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00024}00024     \}}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00026}00026     \textcolor{keywordtype}{void} SquareRootController::CalculateCommandVelocities(geometry\_msgs::Twist\& ref\_command\_signals)\{}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00027}00027         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classbebop__controller_1_1_base_controller_a4556e6065d4089dfa23ccff27d0d1143}{controller\_active\_}})\{}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00028}00028             ref\_command\_signals.linear.x = 0.0;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00029}00029             ref\_command\_signals.linear.y = 0.0;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00030}00030             ref\_command\_signals.linear.z = 0.0;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00031}00031             ref\_command\_signals.angular.z = 0.0;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00032}00032             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00033}00033         \}}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00034}00034         Vector4 u, e;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00035}00035         \mbox{\hyperlink{classbebop__controller_1_1_base_controller_aac87802accc263d816e53eee4b19c152}{GetErrors}}(e);}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00036}00036         }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00037}00037         Vector4 Ppos;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00038}00038         Ppos.x = P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_ae685746d7246756a70902737ac1d2fa7}{x}}*sqrt(std::abs(e.x));}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00039}00039         Ppos.y = P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a6ab61b14159b24c1f362f21d6826a83d}{y}}*sqrt(std::abs(e.y));}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00040}00040         Ppos.z = P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a89b6834e6fceddeeea981a74692279fa}{z}}*sqrt(std::abs(e.z));}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00041}00041         Ppos.yaw = P.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a86c14a81c8b8e58d8f04d90e9221b4ec}{yaw}}*sqrt(std::abs(e.yaw));}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00043}00043         \mbox{\hyperlink{classbebop__controller_1_1_base_controller_aad4281d8556b2b46f3bbdd2e9e27de09}{CalculateLeashLength}}(e, P);}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00044}00044         \mbox{\hyperlink{classbebop__controller_1_1_base_controller_a8188301416dd6bf5696307536a4595c2}{LimitPositionErrors}}(e);}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00045}00045         }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00046}00046         u.x = (-\/Ppos.x*e.x + RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_ae685746d7246756a70902737ac1d2fa7}{x}}*\mbox{\hyperlink{classbebop__controller_1_1_base_controller_af6088eb708f8d4155e5512a0fd3a3ffc}{command\_trajectory\_}}.velocity\_W[0])/norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a492721ca2a4bd29f5ac5b07c8a5a5700}{horizontal}};}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00047}00047         u.y = (-\/Ppos.y*e.y + RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a6ab61b14159b24c1f362f21d6826a83d}{y}}*\mbox{\hyperlink{classbebop__controller_1_1_base_controller_af6088eb708f8d4155e5512a0fd3a3ffc}{command\_trajectory\_}}.velocity\_W[1])/norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a492721ca2a4bd29f5ac5b07c8a5a5700}{horizontal}};}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00048}00048         u.z = (-\/Ppos.z*e.z + RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a89b6834e6fceddeeea981a74692279fa}{z}}*\mbox{\hyperlink{classbebop__controller_1_1_base_controller_af6088eb708f8d4155e5512a0fd3a3ffc}{command\_trajectory\_}}.velocity\_W[2])/norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a1c8c966f6384984fc6127ffb1dc148c4}{vertical}};}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00049}00049         u.yaw = (-\/Ppos.yaw*e.yaw + RG.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a86c14a81c8b8e58d8f04d90e9221b4ec}{yaw}}*\mbox{\hyperlink{classbebop__controller_1_1_base_controller_af6088eb708f8d4155e5512a0fd3a3ffc}{command\_trajectory\_}}.angular\_velocity\_W[2])*RAD\_2\_DEG/norm.\mbox{\hyperlink{structbebop__controller_1_1_normalize_a81ea78bea6e2f30c01893c5d00039dc8}{rotation}};}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00051}00051         ref\_command\_signals.linear.x = \mbox{\hyperlink{namespacebebop__controller_adbb5ce519c9ccec2a03354540b0d30fe}{clamp}}(cos(\mbox{\hyperlink{classbebop__controller_1_1_base_controller_aca60bbaed0b611dd3630ed992eb3c7f5}{state}}.\mbox{\hyperlink{structbebop__controller_1_1_state_af32acde2ca31549c11ee184223b65da3}{orientation}}.\mbox{\hyperlink{structbebop__controller_1_1_vector3_a27a5792df863e68a43e1bb8b697e74b4}{z}})*u.x -\/ sin(\mbox{\hyperlink{classbebop__controller_1_1_base_controller_aca60bbaed0b611dd3630ed992eb3c7f5}{state}}.\mbox{\hyperlink{structbebop__controller_1_1_state_af32acde2ca31549c11ee184223b65da3}{orientation}}.\mbox{\hyperlink{structbebop__controller_1_1_vector3_a27a5792df863e68a43e1bb8b697e74b4}{z}})*u.y,\mbox{\hyperlink{classbebop__controller_1_1_base_controller_a870f62f9731f89bfe9fd7107615b672e}{max\_speed}}.\mbox{\hyperlink{structbebop__controller_1_1_vector4_ae685746d7246756a70902737ac1d2fa7}{x}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00052}00052         ref\_command\_signals.linear.y = \mbox{\hyperlink{namespacebebop__controller_adbb5ce519c9ccec2a03354540b0d30fe}{clamp}}(sin(\mbox{\hyperlink{classbebop__controller_1_1_base_controller_aca60bbaed0b611dd3630ed992eb3c7f5}{state}}.\mbox{\hyperlink{structbebop__controller_1_1_state_af32acde2ca31549c11ee184223b65da3}{orientation}}.\mbox{\hyperlink{structbebop__controller_1_1_vector3_a27a5792df863e68a43e1bb8b697e74b4}{z}})*u.x + cos(\mbox{\hyperlink{classbebop__controller_1_1_base_controller_aca60bbaed0b611dd3630ed992eb3c7f5}{state}}.\mbox{\hyperlink{structbebop__controller_1_1_state_af32acde2ca31549c11ee184223b65da3}{orientation}}.\mbox{\hyperlink{structbebop__controller_1_1_vector3_a27a5792df863e68a43e1bb8b697e74b4}{z}})*u.y,\mbox{\hyperlink{classbebop__controller_1_1_base_controller_a870f62f9731f89bfe9fd7107615b672e}{max\_speed}}.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a6ab61b14159b24c1f362f21d6826a83d}{y}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00053}00053         ref\_command\_signals.linear.z = \mbox{\hyperlink{namespacebebop__controller_adbb5ce519c9ccec2a03354540b0d30fe}{clamp}}(u.z,\mbox{\hyperlink{classbebop__controller_1_1_base_controller_a870f62f9731f89bfe9fd7107615b672e}{max\_speed}}.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a89b6834e6fceddeeea981a74692279fa}{z}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00054}00054         ref\_command\_signals.angular.z = \mbox{\hyperlink{namespacebebop__controller_adbb5ce519c9ccec2a03354540b0d30fe}{clamp}}(u.yaw,\mbox{\hyperlink{classbebop__controller_1_1_base_controller_a870f62f9731f89bfe9fd7107615b672e}{max\_speed}}.\mbox{\hyperlink{structbebop__controller_1_1_vector4_a86c14a81c8b8e58d8f04d90e9221b4ec}{yaw}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00055}00055     \}}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00057}00057 \}}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00059}\mbox{\hyperlink{square__root__controller_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{00059}} \textcolor{keywordtype}{int} \mbox{\hyperlink{square__root__controller_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv)\{}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00060}00060     ros::init(argc, argv, \textcolor{stringliteral}{"{}square\_root\_controller\_node"{}});}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00061}00061     ros::NodeHandle nh;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00062}00062     \mbox{\hyperlink{classbebop__controller_1_1_square_root_controller}{bebop\_controller::SquareRootController}} square\_root\_controller;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00063}00063     ros::spin();}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00064}00064     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{square__root__controller_8cpp_source_l00065}00065 \}}

\end{DoxyCode}
